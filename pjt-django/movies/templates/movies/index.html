{% extends 'base.html' %}
{% load static %}


{% block style %}
{% endblock  %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
{% comment %} 모달이 닫힐때 영상이 멈추도록 구성 {% endcomment %}
<script>
  $(function(){
    $('.modal').on('hidden.bs.modal', function (e) {
      $iframe = $(this).find("iframe");
      $iframe.attr("src", $iframe.attr("src"));
    });
  });
</script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
<body style="background-color: 	white">   
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 row-cols-xxl-6 ms-4">      
      {% for movie in movies  %}  
        <div class="main-container col mb-4">
          <div class="img-container card bg-dark text-white" style="width: 17rem;">          
            <img src={{ "https://www.themoviedb.org/t/p/w300_and_h450_bestv2"|add:movie.poster_path }} class="card-img img-thumbnail" alt="포스터 이미지">
            <div class="card-img-overlay d-flex align-items-end">
              <h5 class="text card-title">{{ movie.title }}</h5>
              <button class="play-btn video-btn" data-bs-toggle="modal" data-bs-target="#exampleModal{{movie.pk}}"><i class="bi bi-play-circle fs-1" style="text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black; background-"></i></button>     
            </div>
          </div>
        </div>    
      {% comment %} Modal {% endcomment %}
        <div class="modal fade bg-dark" id="exampleModal{{movie.pk}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header bg-black text-white ">
                <h5 class="modal-title fs-3" id="exampleModalLabel">{{ movie.title }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body bg-black text-white">              
                <div class="ratio ratio-16x9">
                  <iframe class="embed-responsive-item"  width="560" height="315" src={{"https://www.youtube.com/embed/"|add:movie.trailer_path }} frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="javascript::player.api('pause')">Close</button>
                <a class="btn btn-dark" role="button" href="{% url 'movies:detail' movie.pk %}">Go to Movie Detail</a>
              </div>
            </div>
          </div>
        </div>     
      {% endfor %}
    </div>
  </body>
{% endblock %}
 

<style>

</style>
